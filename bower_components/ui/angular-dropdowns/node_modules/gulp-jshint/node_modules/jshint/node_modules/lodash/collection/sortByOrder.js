var baseSortByOrder = require('../internal/baseSortByOrder'),
    isArray = require('../lang/isArray'),
    isIterateeCall = require('../internal/isIterateeCall');

/**
 * This method is like `_.sortByAll` except that it allows specifying the
 * sort orders of the property names to sort by. A truthy value in `orders`
 * will sort the corresponding property name in ascending order while a
 * falsey value will sort it in descending order.
 *
 * @static
 * @memberOf _
 * @category Collection
 * @param {Array|Object|string} collection The collection to iterate over.
 * @param {string[]} props The property names to sort by.
 * @param {boolean[]} orders The sort orders of `props`.
 * @param- {Object} [guard] Enables use as a callback for functions like `_.reduce`.
 * @returns {Array} Returns the new sorted array.
 * @example
 *
 * var users = [
 *   { 'users': 'barney', 'age': 26 },
 *   { 'users': 'fred',   'age': 40 },
 *   { 'users': 'barney', 'age': 36 },
 *   { 'users': 'fred',   'age': 30 }
 * ];
 *
 * // sort by `users` in ascending order and by `age` in descending order
 * _.map(_.sortByOrder(users, ['users', 'age'], [true, false]), _.values);
 * // => [['barney', 36], ['barney', 26], ['fred', 40], ['fred', 30]]
 */
function sortByOrder(collection, props, orders, guard) {
  if (collection == null) {
    return [];
  }
  if (guard && isIterateeCall(props, orders, guard)) {
    orders = null;
  }
  if (!isArray(props)) {
    props = props == null ? [] : [props];
  }
  if (!isArray(orders)) {
    orders = orders == null ? [] : [orders];
  }
  return baseSortByOrder(collection, props, orders);
}

module.exports = sortByOrder;
